{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport firebase from \"firebase\";\n\nvar Fire = function () {\n  function Fire() {\n    var _this = this;\n\n    _classCallCheck(this, Fire);\n\n    this.init = function () {\n      if (!firebase.apps.length) {\n        var connect = firebase.initializeApp({\n          apiKey: \"AIzaSyBaCGsD_rNL97xPUs6_PuFkDucigLE2M2E\",\n          authDomain: \"react-native-chat-app-9c1fc.firebaseapp.com\",\n          projectId: \"react-native-chat-app-9c1fc\",\n          storageBucket: \"react-native-chat-app-9c1fc.appspot.com\",\n          messagingSenderId: \"827190282713\",\n          appId: \"1:827190282713:web:10aee5e7d3a34ccc62f1c8\",\n          measurementId: \"G-Z4FY67W7BJ\"\n        });\n        console.log(\"Check connect:\", connect);\n        firebase.analytics();\n      }\n    };\n\n    this.checkAuth = function () {\n      firebase.auth().onAuthStateChanged(function (user) {\n        console.log(\"CHeck user:\", user);\n\n        if (!user) {\n          firebase.auth().signInAnonymously();\n        }\n      });\n    };\n\n    this.send = function (messages) {\n      messages.forEach(function (item) {\n        var message = {\n          text: item.text,\n          timestamp: firebase.database.ServerValue.TIMESTAMP,\n          user: item.user\n        };\n\n        _this.db.push(message);\n      });\n    };\n\n    this.parse = function (message) {\n      var _message$val = message.val(),\n          user = _message$val.user,\n          text = _message$val.text,\n          timestamp = _message$val.timestamp;\n\n      var _id = message.key;\n      var createdAt = new Date(timestamp);\n      return {\n        _id: _id,\n        createdAt: createdAt,\n        text: text,\n        user: user\n      };\n    };\n\n    this.get = function (callback) {\n      _this.db.on('child_added', function (snapshot) {\n        return callback(_this.parse(snapshot));\n      });\n    };\n\n    this.init();\n    this.checkAuth();\n  }\n\n  _createClass(Fire, [{\n    key: \"off\",\n    value: function off() {\n      this.db.off();\n    }\n  }, {\n    key: \"db\",\n    get: function get() {\n      return firebase.database().ref(\"messages\");\n    }\n  }, {\n    key: \"uid\",\n    get: function get() {\n      return (firebase.auth().currentUser || {}).uid;\n    }\n  }]);\n\n  return Fire;\n}();\n\nexport default new Fire();","map":{"version":3,"sources":["F:/Bai_hoc/Nam 4/HK1/DDNC/Seminar/Firebase Chat app/FirebaseChat/Fire.js"],"names":["firebase","Fire","init","apps","length","connect","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","console","log","analytics","checkAuth","auth","onAuthStateChanged","user","signInAnonymously","send","messages","forEach","item","message","text","timestamp","database","ServerValue","TIMESTAMP","db","push","parse","val","_id","key","createdAt","Date","get","callback","on","snapshot","off","ref","currentUser","uid"],"mappings":";;AAAA,OAAOA,QAAP,MAAqB,UAArB;;IAEMC,I;AACF,kBACA;AAAA;;AAAA;;AAAA,SAKAC,IALA,GAKO,YAAK;AACR,UAAG,CAACF,QAAQ,CAACG,IAAT,CAAcC,MAAlB,EACA;AACI,YAAMC,OAAO,GAACL,QAAQ,CAACM,aAAT,CAAuB;AACjCC,UAAAA,MAAM,EAAE,yCADyB;AAEjCC,UAAAA,UAAU,EAAE,6CAFqB;AAGjCC,UAAAA,SAAS,EAAE,6BAHsB;AAIjCC,UAAAA,aAAa,EAAE,yCAJkB;AAKjCC,UAAAA,iBAAiB,EAAE,cALc;AAMjCC,UAAAA,KAAK,EAAE,2CAN0B;AAOjCC,UAAAA,aAAa,EAAE;AAPkB,SAAvB,CAAd;AASAC,QAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA6BV,OAA7B;AACAL,QAAAA,QAAQ,CAACgB,SAAT;AACH;AACJ,KApBD;;AAAA,SAsBAC,SAtBA,GAsBY,YAAK;AACbjB,MAAAA,QAAQ,CAACkB,IAAT,GAAgBC,kBAAhB,CAAmC,UAAAC,IAAI,EAAE;AACrCN,QAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA0BK,IAA1B;;AACA,YAAG,CAACA,IAAJ,EACA;AACIpB,UAAAA,QAAQ,CAACkB,IAAT,GAAgBG,iBAAhB;AACH;AACJ,OAND;AAOH,KA9BD;;AAAA,SAgCAC,IAhCA,GAgCO,UAACC,QAAD,EAAa;AAChBA,MAAAA,QAAQ,CAACC,OAAT,CAAiB,UAAAC,IAAI,EAAE;AACnB,YAAMC,OAAO,GAAC;AACVC,UAAAA,IAAI,EAACF,IAAI,CAACE,IADA;AAEVC,UAAAA,SAAS,EAAC5B,QAAQ,CAAC6B,QAAT,CAAkBC,WAAlB,CAA8BC,SAF9B;AAGVX,UAAAA,IAAI,EAACK,IAAI,CAACL;AAHA,SAAd;;AAKA,QAAA,KAAI,CAACY,EAAL,CAAQC,IAAR,CAAaP,OAAb;AACH,OAPD;AAQH,KAzCD;;AAAA,SA2CAQ,KA3CA,GA2CM,UAAAR,OAAO,EAAE;AAAA,yBACiBA,OAAO,CAACS,GAAR,EADjB;AAAA,UACJf,IADI,gBACJA,IADI;AAAA,UACCO,IADD,gBACCA,IADD;AAAA,UACMC,SADN,gBACMA,SADN;;AAAA,UAEAQ,GAFA,GAEKV,OAFL,CAEJW,GAFI;AAGX,UAAMC,SAAS,GAAC,IAAIC,IAAJ,CAASX,SAAT,CAAhB;AAEA,aAAO;AACHQ,QAAAA,GAAG,EAAHA,GADG;AAEHE,QAAAA,SAAS,EAATA,SAFG;AAGHX,QAAAA,IAAI,EAAJA,IAHG;AAIHP,QAAAA,IAAI,EAAJA;AAJG,OAAP;AAMH,KAtDD;;AAAA,SAwDAoB,GAxDA,GAwDI,UAAAC,QAAQ,EAAE;AACV,MAAA,KAAI,CAACT,EAAL,CAAQU,EAAR,CAAW,aAAX,EAAyB,UAAAC,QAAQ;AAAA,eAAEF,QAAQ,CAAC,KAAI,CAACP,KAAL,CAAWS,QAAX,CAAD,CAAV;AAAA,OAAjC;AAEH,KA3DD;;AACI,SAAKzC,IAAL;AACA,SAAKe,SAAL;AACH;;;;0BA0DI;AACD,WAAKe,EAAL,CAAQY,GAAR;AACH;;;wBAED;AACI,aAAO5C,QAAQ,CAAC6B,QAAT,GAAoBgB,GAApB,CAAwB,UAAxB,CAAP;AACH;;;wBAGD;AACI,aAAO,CAAC7C,QAAQ,CAACkB,IAAT,GAAgB4B,WAAhB,IAA+B,EAAhC,EAAoCC,GAA3C;AACH;;;;;;AAKL,eAAe,IAAI9C,IAAJ,EAAf","sourcesContent":["import firebase from \"firebase\";\r\n\r\nclass Fire{\r\n    constructor()\r\n    {\r\n        this.init();\r\n        this.checkAuth();\r\n    }\r\n\r\n    init = () =>{\r\n        if(!firebase.apps.length)\r\n        {\r\n            const connect=firebase.initializeApp({\r\n                apiKey: \"AIzaSyBaCGsD_rNL97xPUs6_PuFkDucigLE2M2E\",\r\n                authDomain: \"react-native-chat-app-9c1fc.firebaseapp.com\",\r\n                projectId: \"react-native-chat-app-9c1fc\",\r\n                storageBucket: \"react-native-chat-app-9c1fc.appspot.com\",\r\n                messagingSenderId: \"827190282713\",\r\n                appId: \"1:827190282713:web:10aee5e7d3a34ccc62f1c8\",\r\n                measurementId: \"G-Z4FY67W7BJ\"\r\n            })\r\n            console.log(\"Check connect:\",connect);\r\n            firebase.analytics();\r\n        }\r\n    };\r\n\r\n    checkAuth = () =>{\r\n        firebase.auth().onAuthStateChanged(user=>{\r\n            console.log(\"CHeck user:\",user);\r\n            if(!user)\r\n            {\r\n                firebase.auth().signInAnonymously();\r\n            }\r\n        })\r\n    }\r\n\r\n    send = (messages) =>{\r\n        messages.forEach(item=>{\r\n            const message={\r\n                text:item.text,\r\n                timestamp:firebase.database.ServerValue.TIMESTAMP,\r\n                user:item.user\r\n            }\r\n            this.db.push(message);\r\n        })\r\n    }\r\n\r\n    parse=message=>{\r\n        const {user,text,timestamp}=message.val();\r\n        const {key:_id}=message;\r\n        const createdAt=new Date(timestamp);\r\n\r\n        return {\r\n            _id,\r\n            createdAt,\r\n            text,\r\n            user\r\n        }\r\n    }\r\n\r\n    get=callback=>{\r\n        this.db.on('child_added',snapshot=>callback(this.parse(snapshot)));\r\n\r\n    };\r\n\r\n    off(){\r\n        this.db.off();\r\n    }\r\n    get db()\r\n    {\r\n        return firebase.database().ref(\"messages\");\r\n    }\r\n\r\n    get uid()\r\n    {\r\n        return (firebase.auth().currentUser || {}).uid;\r\n    }\r\n\r\n\r\n}\r\n\r\nexport default new Fire();"]},"metadata":{},"sourceType":"module"}